<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Products - ShopEasy</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Chatbot Styles -->
    <link rel="stylesheet" href="styles/chatbot.css" />

    <!-- Image Search Styles -->
    <link rel="stylesheet" href="styles/image-search.css" />
  </head>
  <body>
    <!-- Header (same as index.html) -->
    <header class="header">
      <div class="header-top">
        <div class="container">
          <div class="header-top-content">
            <div class="header-top-left">
              <span class="location">
                <svg
                  class="location-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"
                  />
                  <circle cx="12" cy="10" r="3" />
                </svg>
                Deliver to Mumbai 400001
              </span>
            </div>
            <div class="header-top-right">
              <span>Customer Service</span>
              <span>Sell on ShopEasy</span>
            </div>
          </div>
        </div>
      </div>

      <div class="header-main">
        <div class="container">
          <div class="header-main-content">
            <a href="index.html" class="logo">
              <div class="logo-text">ShopEasy</div>
            </a>

            <form class="search-form" onsubmit="handleSearch(event)">
              <div class="search-wrapper">
                <input
                  type="text"
                  id="searchInput"
                  class="search-input"
                  placeholder="Search for products, brands and more..."
                />
                <button
                  type="button"
                  class="voice-search-btn"
                  onclick="voiceSearch && voiceSearch.startVoiceSearch('products')"
                  title="Voice Search"
                >
                  <span class="voice-icon">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"
                      />
                      <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                      <line x1="12" x2="12" y1="19" y2="22" />
                      <line x1="8" x2="16" y1="22" y2="22" />
                    </svg>
                  </span>
                </button>
                <button
                  class="image-search-btn"
                  onclick="imageSearch.openModal()"
                  title="Search by Image"
                >
                  <span class="image-icon">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                      <circle cx="9" cy="9" r="2" />
                      <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21" />
                      <circle cx="17" cy="7" r="1" />
                    </svg>
                  </span>
                </button>
                <button type="submit" class="search-btn">
                  <svg
                    class="search-icon"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <circle cx="11" cy="11" r="8" />
                    <path d="m21 21-4.3-4.3" />
                  </svg>
                </button>
              </div>
            </form>

            <div class="header-right">
              <button
                class="account-btn"
                onclick="authSystem && authSystem.openAuthModal()"
              >
                <svg
                  class="account-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
                <span class="account-text">Account</span>
              </button>

              <a href="cart.html" class="cart-btn">
                <div class="cart-icon-wrapper">
                  <svg
                    class="cart-icon"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path
                      d="m9 22 3-3-3-3M3 3h.621a1 1 0 0 1 .958.713l1.42 4.982A1 1 0 0 0 6.957 9H19a1 1 0 0 1 .97 1.243l-2 8A1 1 0 0 1 17 19H6a1 1 0 0 1-.97-.757L2 2H1"
                    />
                    <circle cx="9" cy="22" r="1" />
                    <circle cx="20" cy="22" r="1" />
                  </svg>
                  <span class="cart-count" id="cartCount">0</span>
                </div>
                <span class="cart-text">Cart</span>
              </a>
            </div>
          </div>
        </div>
      </div>

      <div class="header-nav">
        <div class="container">
          <nav class="nav-links">
            <a href="products.html" class="nav-link">All Categories</a>
            <a href="products.html?category=Electronics" class="nav-link"
              >Electronics</a
            >
            <a href="products.html?category=Fashion" class="nav-link"
              >Fashion</a
            >
            <a href="products.html?category=Home & Kitchen" class="nav-link"
              >Home & Kitchen</a
            >
            <a href="products.html?category=Toys & Games" class="nav-link"
              >Toys & Games</a
            >
            <a
              href="products.html?category=Beauty & Personal Care"
              class="nav-link"
              >Beauty</a
            >
            <a href="products.html?category=Sports & Fitness" class="nav-link"
              >Sports</a
            >
            <a href="products.html?category=Books & Stationery" class="nav-link"
              >Books</a
            >
            <a href="products.html?category=Groceries & Food" class="nav-link"
              >Groceries</a
            >
          </nav>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main>
      <div class="container" style="padding-top: 2rem; padding-bottom: 2rem">
        <!-- Breadcrumb -->
        <nav class="breadcrumb" id="breadcrumb" style="margin-bottom: 1.5rem">
          <!-- Will be populated by JavaScript -->
        </nav>

        <!-- Page Header -->
        <div class="page-header" style="margin-bottom: 2rem">
          <h1 id="pageTitle" style="font-size: 1.875rem; font-weight: 700">
            All Products
          </h1>
          <p id="resultsCount" style="color: #6b7280; margin-top: 0.5rem">
            Loading products...
          </p>
        </div>

        <!-- Filters and Sort -->
        <div class="filters-section" style="margin-bottom: 2rem">
          <div
            style="
              display: flex;
              flex-wrap: wrap;
              gap: 1rem;
              align-items: center;
              justify-content: space-between;
            "
          >
            <!-- Category Filters -->
            <div class="category-filters" id="categoryFilters">
              <!-- Will be populated by JavaScript -->
            </div>

            <!-- Sort Options -->
            <div style="display: flex; align-items: center; gap: 0.5rem">
              <svg
                style="width: 1rem; height: 1rem; color: #6b7280"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M3 6h18" />
                <path d="M7 12h10" />
                <path d="M10 18h4" />
              </svg>
              <select
                id="sortSelect"
                style="
                  padding: 0.5rem 1rem;
                  border: 1px solid #d1d5db;
                  border-radius: 0.5rem;
                  background: white;
                  outline: none;
                "
                onchange="applySorting()"
              >
                <option value="relevance">Sort by Relevance</option>
                <option value="price-low">Price: Low to High</option>
                <option value="price-high">Price: High to Low</option>
                <option value="rating">Customer Rating</option>
                <option value="discount">Discount</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Products Grid -->
        <div class="products-grid" id="productsGrid">
          <!-- Products will be loaded by JavaScript -->
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="text-center" style="padding: 3rem 0">
          <div class="pulse" style="color: #6b7280">Loading products...</div>
        </div>

        <!-- No Results -->
        <div id="noResults" class="text-center hidden" style="padding: 3rem 0">
          <svg
            style="
              width: 4rem;
              height: 4rem;
              margin: 0 auto 1rem;
              color: #d1d5db;
            "
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="11" cy="11" r="8" />
            <path d="m21 21-4.3-4.3" />
          </svg>
          <h2 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem">
            No products found
          </h2>
          <p style="color: #6b7280; margin-bottom: 2rem">
            Try adjusting your search or filter criteria
          </p>
          <a href="products.html" class="btn btn-primary">View All Products</a>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h3>ShopEasy</h3>
            <p>
              Your one-stop destination for all daily essentials at the best
              prices.
            </p>
          </div>
          <div class="footer-section">
            <h4>Quick Links</h4>
            <ul>
              <li><a href="#">About Us</a></li>
              <li><a href="#">Contact</a></li>
              <li><a href="#">Help</a></li>
              <li><a href="#">Careers</a></li>
            </ul>
          </div>
          <div class="footer-section">
            <h4>Categories</h4>
            <ul>
              <li>
                <a href="products.html?category=Electronics">Electronics</a>
              </li>
              <li><a href="products.html?category=Fashion">Fashion</a></li>
              <li>
                <a href="products.html?category=Home & Kitchen"
                  >Home & Kitchen</a
                >
              </li>
              <li>
                <a href="products.html?category=Groceries & Food">Groceries</a>
              </li>
            </ul>
          </div>
          <div class="footer-section">
            <h4>Customer Service</h4>
            <ul>
              <li><a href="#">Return Policy</a></li>
              <li><a href="#">Privacy Policy</a></li>
              <li><a href="#">Terms of Service</a></li>
              <li><a href="#">Track Order</a></li>
            </ul>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2024 ShopEasy. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script src="script.js"></script>
    <script src="voice-search.js"></script>
    <script src="ar-viewer.js"></script>
    <script src="recommendations.js"></script>
    <script src="store-locator.js"></script>
    <script src="auth-system.js"></script>

    <!-- AR Feature Scripts -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.min.js"></script>
    <script src="scripts/ar-viewer.js"></script>
    <script src="scripts/ar-integration.js"></script>

    <!-- AR Styles -->
    <link rel="stylesheet" href="styles/ar-viewer.css" />
    <script>
      // Products page specific JavaScript
      let filteredProducts = [];
      let currentCategory = "All";
      let searchTerm = "";
      let sortBy = "relevance";

      function getUrlParams() {
        const params = new URLSearchParams(window.location.search);
        return {
          category: params.get("category") || "All",
          search: params.get("search") || "",
          sort: params.get("sort") || "relevance",
        };
      }

      function updateBreadcrumb() {
        const breadcrumb = document.getElementById("breadcrumb");
        let breadcrumbHTML =
          '<a href="index.html" style="color: #3b82f6;">Home</a>';

        if (currentCategory !== "All") {
          breadcrumbHTML += ` <span style="margin: 0 0.5rem;">›</span> <span style="color: #111827;">${currentCategory}</span>`;
        }

        if (searchTerm) {
          breadcrumbHTML += ` <span style="margin: 0 0.5rem;">›</span> <span style="color: #111827;">Search: "${searchTerm}"</span>`;
        }

        breadcrumb.innerHTML = breadcrumbHTML;
      }

      function updatePageTitle() {
        const pageTitle = document.getElementById("pageTitle");
        let title = "All Products";

        if (searchTerm) {
          title = `Search results for "${searchTerm}"`;
        } else if (currentCategory !== "All") {
          title = `${currentCategory} Products`;
        }

        pageTitle.textContent = title;
      }

      function createCategoryFilter() {
        const categoryFilters = document.getElementById("categoryFilters");
        const categories = [
          "All",
          "Electronics",
          "Fashion",
          "Home & Kitchen",
          "Toys & Games",
          "Beauty & Personal Care",
          "Sports & Fitness",
          "Books & Stationery",
          "Groceries & Food",
        ];

        categoryFilters.innerHTML = categories
          .map(
            (category) => `
                    <button
                        class="category-filter-btn ${category === currentCategory ? "active" : ""}"
                        onclick="filterByCategory('${category}')"
                        style="
                            padding: 0.5rem 1rem;
                            border: 1px solid ${category === currentCategory ? "#3b82f6" : "#d1d5db"};
                            background: ${category === currentCategory ? "#3b82f6" : "white"};
                            color: ${category === currentCategory ? "white" : "#374151"};
                            border-radius: 1rem;
                            cursor: pointer;
                            font-size: 0.875rem;
                            font-weight: 500;
                            transition: all 0.2s;
                        "
                    >
                        ${category}
                    </button>
                `,
          )
          .join("");
      }

      function filterProducts() {
        let products = window.products;

        // Apply category filter
        if (currentCategory !== "All") {
          products = products.filter(
            (product) => product.category === currentCategory,
          );
        }

        // Apply search filter
        if (searchTerm) {
          const term = searchTerm.toLowerCase();
          products = products.filter(
            (product) =>
              product.name.toLowerCase().includes(term) ||
              product.description.toLowerCase().includes(term) ||
              product.category.toLowerCase().includes(term) ||
              (product.brand && product.brand.toLowerCase().includes(term)),
          );
        }

        // Apply sorting
        switch (sortBy) {
          case "price-low":
            products.sort((a, b) => a.price - b.price);
            break;
          case "price-high":
            products.sort((a, b) => b.price - a.price);
            break;
          case "rating":
            products.sort((a, b) => b.rating - a.rating);
            break;
          case "discount":
            products.sort((a, b) => (b.discount || 0) - (a.discount || 0));
            break;
          default:
            // Keep original order for relevance
            break;
        }

        filteredProducts = products;
        displayProducts();
        updateResultsCount();
      }

      function displayProducts() {
        const productsGrid = document.getElementById("productsGrid");
        const loadingState = document.getElementById("loadingState");
        const noResults = document.getElementById("noResults");

        loadingState.classList.add("hidden");

        if (filteredProducts.length === 0) {
          productsGrid.classList.add("hidden");
          noResults.classList.remove("hidden");
        } else {
          noResults.classList.add("hidden");
          productsGrid.classList.remove("hidden");
          productsGrid.innerHTML = filteredProducts
            .map((product) => window.createProductCard(product))
            .join("");
        }
      }

      function updateResultsCount() {
        const resultsCount = document.getElementById("resultsCount");
        const count = filteredProducts.length;
        resultsCount.textContent = `Showing ${count} result${count !== 1 ? "s" : ""}`;
      }

      function filterByCategory(category) {
        currentCategory = category;
        const url = new URL(window.location);
        if (category === "All") {
          url.searchParams.delete("category");
        } else {
          url.searchParams.set("category", category);
        }
        window.history.pushState({}, "", url);

        createCategoryFilter();
        updateBreadcrumb();
        updatePageTitle();
        filterProducts();
      }

      function applySorting() {
        const sortSelect = document.getElementById("sortSelect");
        sortBy = sortSelect.value;

        const url = new URL(window.location);
        url.searchParams.set("sort", sortBy);
        window.history.pushState({}, "", url);

        filterProducts();
      }

      function handleSearch(event) {
        event.preventDefault();
        const searchInput = document.getElementById("searchInput");
        const term = searchInput.value.trim();

        const url = new URL(window.location);
        if (term) {
          url.searchParams.set("search", term);
        } else {
          url.searchParams.delete("search");
        }
        window.history.pushState({}, "", url);

        searchTerm = term;
        updateBreadcrumb();
        updatePageTitle();
        filterProducts();
      }

      // Initialize products page
      document.addEventListener("DOMContentLoaded", function () {
        const params = getUrlParams();
        currentCategory = params.category;
        searchTerm = params.search;
        sortBy = params.sort;

        // Set search input value
        const searchInput = document.getElementById("searchInput");
        if (searchInput) {
          searchInput.value = searchTerm;
        }

        // Set sort select value
        const sortSelect = document.getElementById("sortSelect");
        if (sortSelect) {
          sortSelect.value = sortBy;
        }

        createCategoryFilter();
        updateBreadcrumb();
        updatePageTitle();
        filterProducts();
      });
    </script>

    <!-- Chatbot Integration -->
    <script src="scripts/chatbot.js"></script>
    <div id="chatbot-component"></div>
    <script>
      // Load chatbot component
      fetch("components/chatbot.html")
        .then((response) => response.text())
        .then((html) => {
          document.getElementById("chatbot-component").innerHTML = html;
        });
    </script>

    <!-- Image Search Integration -->
    <script src="scripts/image-search.js"></script>
  </body>
</html>
